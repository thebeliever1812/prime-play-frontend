import * as z from "zod";

export const emailValidation = z.email();

export const passwordValidation = z
    .string()
    .trim()
    .min(6, "Must be at least 6 characters")
    .max(10, "Must not exceed 10 characters");

export const usernameValidation = z
    .string()
    .lowercase()
    .trim()
    .min(8, "Must be at least 8 characters")
    .max(12, "Must not exceed 12 characters")
    .regex(
        /^[a-z0-9_]+$/,
        "Username must be lowercase and contain only letters, numbers, or underscores (no spaces)"
    );

export const UserRegisterSchema = z.object({
    username: usernameValidation,
    fullName: z
        .string()
        .trim()
        .min(2, "Must be at least 2 characters")
        .regex(
            /^^[A-Za-z]+([ '-][A-Za-z]+)*$/,
            "Full name must start with a capital letter and can include multiple capitalized words (e.g., 'Basir Ahmad')"
        ),
    email: emailValidation,
    password: passwordValidation,
    avatar: z
        .any()
        .optional()
        .refine((field) => {
            if (!field || field.length === 0) {
                return true;
            }
            const file = field[0];
            return file.type.startsWith("image/");
        }, "Only image file is allowed"),
    coverImage: z
        .any()
        .optional()
        .refine((field) => {
            if (!field || field.length === 0) {
                return true;
            }
            const file = field[0];
            return file.type.startsWith("image/");
        }, "Only image file is allowed"),
});
